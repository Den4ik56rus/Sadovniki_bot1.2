#!/usr/bin/env python3
# test_culture_classification_advanced.py

"""
–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫—É–ª—å—Ç—É—Ä—ã - —Å–ª–æ–∂–Ω—ã–µ –∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–µ –∫–µ–π—Å—ã.

–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã:
- –û–ø–µ—á–∞—Ç–∫–∏
- –†–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è —Ä–µ—á—å
- –ù–µ—è–≤–Ω—ã–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
- –°–º–µ—à–∞–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã
"""

import asyncio
import sys
from typing import List, Tuple

sys.path.insert(0, "/Users/denis/Desktop/Main/Sadovniki-bot/Sadovniki_bot1.2")

from src.services.llm.classification_llm import detect_culture_name
from src.services.db.pool import init_db_pool, close_db_pool


# –°–ª–æ–∂–Ω—ã–µ –∏ –∫–∞–≤–µ—Ä–∑–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–µ–π—Å—ã
ADVANCED_TEST_CASES: List[Tuple[str, str, str]] = [
    # (—Ç–µ–∫—Å—Ç, –æ–∂–∏–¥–∞–µ–º–∞—è –∫—É–ª—å—Ç—É—Ä–∞, –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã)

    # === –û–ü–ï–ß–ê–¢–ö–ò –ò –û–†–§–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò ===
    ("–£ –∫–ª–∫–±–Ω–∏–∫–∏ –∂–µ–ª—Ç–µ—é—Ç –ª–∏—Å—Ç—å—è", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–û–ø–µ—á–∞—Ç–∫–∞ –≤ —Å–ª–æ–≤–µ '–∫–ª—É–±–Ω–∏–∫–∞'"),
    ("–ú–∞–ª–Ω–∞ –Ω–µ –ø–ª–æ–¥–æ–Ω–æ—Å–∏—Ç", "–º–∞–ª–∏–Ω–∞ –æ–±—â–∞—è", "–û–ø–µ—á–∞—Ç–∫–∞ –≤ —Å–ª–æ–≤–µ '–º–∞–ª–∏–Ω–∞'"),
    ("–ì–æ–ª—É–±–∫–∞ –∫—Ä–∞—Å–Ω–µ–µ—Ç", "–≥–æ–ª—É–±–∏–∫–∞", "–û–ø–µ—á–∞—Ç–∫–∞ '–≥–æ–ª—É–±–∫–∞' –≤–º–µ—Å—Ç–æ '–≥–æ–ª—É–±–∏–∫–∞'"),

    # === –†–ê–ó–ì–û–í–û–†–ù–ê–Ø –†–ï–ß–¨ ===
    ("–ú–æ—è –∫–ª—É–±–∞ —Å–æ–≤—Å–µ–º –Ω–µ —Ä–∞—Å—Ç–µ—Ç", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–†–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–µ '–∫–ª—É–±–∞'"),
    ("–ú–∞–ª–∏–Ω–∫–∞ –∂–µ–ª—Ç–µ–µ—Ç", "–º–∞–ª–∏–Ω–∞ –æ–±—â–∞—è", "–£–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω–æ–µ '–º–∞–ª–∏–Ω–∫–∞'"),
    ("–ö—É—Å—Ç–∏–∫–∏ —Å–º–æ—Ä–æ–¥–∏–Ω—ã –±–æ–ª–µ—é—Ç", "—Å–º–æ—Ä–æ–¥–∏–Ω–∞", "–£–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω–æ–µ '–∫—É—Å—Ç–∏–∫–∏'"),

    # === –ù–ï–Ø–í–ù–´–ï –£–ü–û–ú–ò–ù–ê–ù–ò–Ø ===
    ("–°–∞–∂–µ–Ω—Ü—ã —Ñ—Ä–∏–≥–æ –ø–ª–æ—Ö–æ –ø—Ä–∏–∂–∏–≤–∞—é—Ç—Å—è", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–§—Ä–∏–≥–æ = –∫–ª—É–±–Ω–∏–∫–∞ (—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π —Ç–µ—Ä–º–∏–Ω)"),
    ("–ù–°–î –∫—É–ª—å—Ç—É—Ä–∞ –Ω–µ –¥–∞–µ—Ç —É—Ä–æ–∂–∞–π", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–ù–°–î –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫—É–ª—å—Ç—É—Ä—ã"),
    ("–†–µ–º–æ–Ω—Ç–∞–Ω—Ç–∫–∞ —Å–æ—Ö–Ω–µ—Ç", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–†–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–µ '—Ä–µ–º–æ–Ω—Ç–∞–Ω—Ç–∫–∞' –±–µ–∑ –∫—É–ª—å—Ç—É—Ä—ã"),

    # === –ö–û–ù–¢–ï–ö–°–¢–ù–´–ï –í–û–ü–†–û–°–´ (–±–µ–∑ –ø—Ä—è–º–æ–≥–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫—É–ª—å—Ç—É—Ä—ã) ===
    ("–ü–æ—á–µ–º—É —è–≥–æ–¥—ã –º–µ–ª–∫–∏–µ?", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–¢–æ–ª—å–∫–æ '—è–≥–æ–¥—ã' –±–µ–∑ –∫—É–ª—å—Ç—É—Ä—ã"),
    ("–õ–∏—Å—Ç—å—è —Å–∫—Ä—É—á–∏–≤–∞—é—Ç—Å—è, —á—Ç–æ –¥–µ–ª–∞—Ç—å?", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–ë–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫—É–ª—å—Ç—É—Ä—ã"),
    ("–ö–æ–≥–¥–∞ –ª—É—á—à–µ —Å–∞–∂–∞—Ç—å?", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–ë–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫—É–ª—å—Ç—É—Ä—ã"),

    # === –°–ú–ï–®–ê–ù–ù–´–ï –°–ò–ì–ù–ê–õ–´ (–ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è) ===
    ("–£ –º–∞–ª–∏–Ω—ã –∫–∞–∫ —É –∫–ª—É–±–Ω–∏–∫–∏ –∂–µ–ª—Ç–µ—é—Ç –ª–∏—Å—Ç—å—è", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–î–≤–µ –∫—É–ª—å—Ç—É—Ä—ã –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏"),
    ("–í–æ–ø—Ä–æ—Å –ø—Ä–æ —Ä–µ–º–æ–Ω—Ç–∞–Ω—Ç–Ω—É—é, —É –º–µ–Ω—è –ª–µ—Ç–Ω—è—è –º–∞–ª–∏–Ω–∞", "–º–∞–ª–∏–Ω–∞ –æ–±—â–∞—è", "–û–±–µ —É–ø–æ–º—è–Ω—É—Ç—ã, –Ω–æ —Ñ–æ–∫—É—Å –Ω–∞ –≤–æ–ø—Ä–æ—Å–µ"),
    ("–ù–µ –∫–ª—É–±–Ω–∏–∫–∞, –∞ –º–∞–ª–∏–Ω–∞ –±–æ–ª–µ–µ—Ç", "–º–∞–ª–∏–Ω–∞ –æ–±—â–∞—è", "–û—Ç—Ä–∏—Ü–∞–Ω–∏–µ –æ–¥–Ω–æ–π, —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥—Ä—É–≥–æ–π"),

    # === –ú–ù–û–ñ–ï–°–¢–í–ï–ù–ù–û–ï –ß–ò–°–õ–û –ò –í–ê–†–ò–ê–¶–ò–ò ===
    ("–ö–ª—É–±–Ω–∏–∫–∏ –∂–µ–ª—Ç–µ—é—Ç", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ"),
    ("–ú–∞–ª–∏–Ω—ã —Å–æ—Ö–Ω—É—Ç", "–º–∞–ª–∏–Ω–∞ –æ–±—â–∞—è", "–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ"),
    ("–Ø–≥–æ–¥—ã –≥–æ–ª—É–±–∏–∫–∏ –º–µ–ª–∫–∏–µ", "–≥–æ–ª—É–±–∏–∫–∞", "–° —É—Ç–æ—á–Ω–µ–Ω–∏–µ–º '—è–≥–æ–¥—ã –≥–æ–ª—É–±–∏–∫–∏'"),

    # === –í–û–ü–†–û–°–´ –° –ù–ï–°–ö–û–õ–¨–ö–ò–ú–ò –ö–£–õ–¨–¢–£–†–ê–ú–ò (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–µ—Ä–≤–æ–π) ===
    ("–ú–æ–∂–Ω–æ –ª–∏ —Å–∞–∂–∞—Ç—å –º–∞–ª–∏–Ω—É —Ä—è–¥–æ–º —Å –∫–ª—É–±–Ω–∏–∫–æ–π?", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–î–≤–µ —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω—ã–µ –∫—É–ª—å—Ç—É—Ä—ã"),
    ("–ì–æ–ª—É–±–∏–∫–∞ –∏ –∂–∏–º–æ–ª–æ—Å—Ç—å - –∫–æ–≥–¥–∞ —Å–∞–∂–∞—Ç—å?", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–î–≤–µ –∫—É–ª—å—Ç—É—Ä—ã"),

    # === –°–ü–ï–¶–ò–§–ò–ß–ï–°–ö–ò–ï –°–û–†–¢–ê –ò –¢–ï–†–ú–ò–ù–´ ===
    ("–°–æ—Ä—Ç –ê–ª—å–±–∏–æ–Ω –∂–µ–ª—Ç–µ–µ—Ç", "–∫–ª—É–±–Ω–∏–∫–∞ —Ä–µ–º–æ–Ω—Ç–∞–Ω—Ç–Ω–∞—è", "–ê–ª—å–±–∏–æ–Ω = —Å–æ—Ä—Ç –∫–ª—É–±–Ω–∏–∫–∏ –ù–°–î"),
    ("–ü–æ–ª–∫–∞ –ø–ª–æ—Ö–æ —Ä–∞—Å—Ç–µ—Ç", "–∫–ª—É–±–Ω–∏–∫–∞ –ª–µ—Ç–Ω—è—è", "–ü–æ–ª–∫–∞ = —Å–æ—Ä—Ç –∫–ª—É–±–Ω–∏–∫–∏"),
    ("–ü–∞—Ç—Ä–∏—Ü–∏—è –¥–∞–µ—Ç –º–∞–ª–æ —è–≥–æ–¥", "–º–∞–ª–∏–Ω–∞ –ª–µ—Ç–Ω—è—è", "–ü–∞—Ç—Ä–∏—Ü–∏—è = —Å–æ—Ä—Ç –º–∞–ª–∏–Ω—ã"),
    ("–•–∏–º–±–æ –¢–æ–ø –Ω–µ –ø–ª–æ–¥–æ–Ω–æ—Å–∏—Ç", "–º–∞–ª–∏–Ω–∞ —Ä–µ–º–æ–Ω—Ç–∞–Ω—Ç–Ω–∞—è", "–•–∏–º–±–æ –¢–æ–ø = —Ä–µ–º–æ–Ω—Ç–∞–Ω—Ç–Ω—ã–π —Å–æ—Ä—Ç"),

    # === –í–û–ü–†–û–°–´ –° –£–ö–ê–ó–ê–ù–ò–ï–ú –¢–ò–ü–ê –ë–ï–ó –°–õ–û–í–ê "–ö–õ–£–ë–ù–ò–ö–ê/–ú–ê–õ–ò–ù–ê" ===
    ("–†–µ–º–æ–Ω—Ç–∞–Ω—Ç–Ω–∞—è –Ω–µ —Ü–≤–µ—Ç–µ—Ç", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–¢–æ–ª—å–∫–æ '—Ä–µ–º–æ–Ω—Ç–∞–Ω—Ç–Ω–∞—è' –±–µ–∑ –∫—É–ª—å—Ç—É—Ä—ã"),
    ("–õ–µ—Ç–Ω—è—è —Å–æ—Ö–Ω–µ—Ç", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–¢–æ–ª—å–∫–æ '–ª–µ—Ç–Ω—è—è' –±–µ–∑ –∫—É–ª—å—Ç—É—Ä—ã"),

    # === –†–ï–ì–ò–û–ù–ê–õ–¨–ù–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò –ò –î–ò–ê–õ–ï–ö–¢–´ ===
    ("–í–∏–∫—Ç–æ—Ä–∏—è –∂–µ–ª—Ç–µ–µ—Ç", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–í–∏–∫—Ç–æ—Ä–∏—è = —É—Å—Ç–∞—Ä–µ–≤—à–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª—É–±–Ω–∏–∫–∏"),
    ("–°–∞–¥–æ–≤–∞—è –∑–µ–º–ª—è–Ω–∏–∫–∞ –±–æ–ª–µ–µ—Ç", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–°–∞–¥–æ–≤–∞—è –∑–µ–º–ª—è–Ω–∏–∫–∞ = –∫–ª—É–±–Ω–∏–∫–∞"),

    # === –°–õ–û–ñ–ù–´–ï –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –í–û–ü–†–û–°–´ ===
    ("pH –ø–æ—á–≤—ã –¥–ª—è –≤–µ—Ä–µ—Å–∫–æ–≤—ã—Ö –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç", "–≥–æ–ª—É–±–∏–∫–∞", "–í–µ—Ä–µ—Å–∫–æ–≤—ã–µ = –≥–æ–ª—É–±–∏–∫–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —è–≥–æ–¥"),
    ("–ö–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å –¥–ª—è –∫—É–ª—å—Ç—É—Ä—ã –ù–°–î", "–æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–ù–°–î –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫—É–ª—å—Ç—É—Ä—ã"),

    # === –í–û–ü–†–û–°–´ –û –†–ê–°–°–ê–î–ï –ò –ü–û–°–ê–î–û–ß–ù–û–ú –ú–ê–¢–ï–†–ò–ê–õ–ï ===
    ("–†–∞—Å—Å–∞–¥–∞ –∑–µ–º–ª—è–Ω–∏–∫–∏ –ø–ª–æ—Ö–∞—è", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–†–∞—Å—Å–∞–¥–∞ –∑–µ–º–ª—è–Ω–∏–∫–∏ = –∫–ª—É–±–Ω–∏–∫–∞"),
    ("–°–∞–∂–µ–Ω—Ü—ã –º–∞–ª–∏–Ω—ã –Ω–µ –ø—Ä–∏–∂–∏–≤–∞—é—Ç—Å—è", "–º–∞–ª–∏–Ω–∞ –æ–±—â–∞—è", "–°–∞–∂–µ–Ω—Ü—ã –º–∞–ª–∏–Ω—ã"),
    ("–ö—É—Å—Ç–∏–∫–∏ –∂–∏–º–æ–ª–æ—Å—Ç–∏ —Å–æ—Ö–Ω—É—Ç", "–∂–∏–º–æ–ª–æ—Å—Ç—å", "–ö—É—Å—Ç–∏–∫–∏ –∂–∏–º–æ–ª–æ—Å—Ç–∏"),

    # === –≠–ú–û–¶–ò–û–ù–ê–õ–¨–ù–´–ï –ò –†–ê–ó–ì–û–í–û–†–ù–´–ï –§–û–†–ú–£–õ–ò–†–û–í–ö–ò ===
    ("–ü–æ–º–æ–≥–∏—Ç–µ! –ö–ª—É–±–Ω–∏–∫–∞ –≤—Å—è –ø—Ä–æ–ø–∞–¥–∞–µ—Ç!", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å"),
    ("SOS –º–∞–ª–∏–Ω–∞ —É–º–∏—Ä–∞–µ—Ç", "–º–∞–ª–∏–Ω–∞ –æ–±—â–∞—è", "SOS + —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è —Ñ–æ—Ä–º–∞"),
    ("–ö–∞—Ä–∞—É–ª! –ì–æ–ª—É–±–∏–∫–∞ —á–µ—Ä–Ω–µ–µ—Ç!", "–≥–æ–ª—É–±–∏–∫–∞", "–í–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∏–ª—å"),

    # === –í–û–ü–†–û–°–´ –° –û–®–ò–ë–û–ß–ù–´–ú–ò –ü–†–ï–î–ü–û–õ–û–ñ–ï–ù–ò–Ø–ú–ò ===
    ("–≠—Ç–æ —Ç–æ—á–Ω–æ –º—É—á–Ω–∏—Å—Ç–∞—è —Ä–æ—Å–∞ –Ω–∞ –∫–ª—É–±–Ω–∏–∫–µ?", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–í–æ–ø—Ä–æ—Å —Å –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º"),
    ("–ú–∞–ª–∏–Ω–∞, –Ω–∞–≤–µ—Ä–Ω–æ–µ, –∑–∞–º–µ—Ä–∑–ª–∞?", "–º–∞–ª–∏–Ω–∞ –æ–±—â–∞—è", "–ù–µ—É–≤–µ—Ä–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞"),

    # === –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò –ë–ï–ó –ü–†–Ø–ú–û–ì–û –£–ü–û–ú–ò–ù–ê–ù–ò–Ø ===
    ("–£—Å—ã –Ω–µ –æ–±—Ä–∞–∑—É—é—Ç—Å—è", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–£—Å—ã = —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞ –∫–ª—É–±–Ω–∏–∫–∏"),
    ("–ö–æ—Ä–Ω–µ–≤–∞—è –ø–æ—Ä–æ—Å–ª—å –Ω–µ —Ä–∞—Å—Ç–µ—Ç", "–º–∞–ª–∏–Ω–∞ –æ–±—â–∞—è", "–ö–æ—Ä–Ω–µ–≤–∞—è –ø–æ—Ä–æ—Å–ª—å = –º–∞–ª–∏–Ω–∞"),

    # === –°–ú–ï–®–ï–ù–ò–ï –†–£–°–°–ö–û–ì–û –ò –õ–ê–¢–ò–ù–ò–¶–´ ===
    ("NSD –∫–ª—É–±–Ω–∏–∫–∞ –∂–µ–ª—Ç–µ–µ—Ç", "–∫–ª—É–±–Ω–∏–∫–∞ —Ä–µ–º–æ–Ω—Ç–∞–Ω—Ç–Ω–∞—è", "NSD –ª–∞—Ç–∏–Ω–∏—Ü–µ–π"),
    ("Klubnika –Ω–µ —Ä–∞—Å—Ç–µ—Ç", "–∫–ª—É–±–Ω–∏–∫–∞ –æ–±—â–∞—è", "–¢—Ä–∞–Ω—Å–ª–∏—Ç"),
]


async def run_advanced_tests():
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã."""

    print("="*80)
    print("–†–ê–°–®–ò–†–ï–ù–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ê–í–¢–û–û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –ö–£–õ–¨–¢–£–†–´")
    print("–°–ª–æ–∂–Ω—ã–µ –∏ –∫–∞–≤–µ—Ä–∑–Ω—ã–µ –∫–µ–π—Å—ã")
    print("="*80)
    print()

    await init_db_pool()

    total = len(ADVANCED_TEST_CASES)
    passed = 0
    failed = 0
    errors_list = []

    for i, (text, expected, description) in enumerate(ADVANCED_TEST_CASES, 1):
        try:
            result = await detect_culture_name(text)
            is_correct = result == expected

            if is_correct:
                status = "‚úÖ PASS"
                passed += 1
            else:
                status = "‚ùå FAIL"
                failed += 1
                errors_list.append({
                    "text": text,
                    "expected": expected,
                    "got": result,
                    "description": description,
                })

            print(f"[{i}/{total}] {status}")
            print(f"  –ö–µ–π—Å: {description}")
            print(f"  –í–æ–ø—Ä–æ—Å: {text}")
            print(f"  –û–∂–∏–¥–∞–ª–æ—Å—å: {expected}")
            print(f"  –ü–æ–ª—É—á–µ–Ω–æ: {result}")
            print()

        except Exception as e:
            status = "üí• ERROR"
            failed += 1
            errors_list.append({
                "text": text,
                "expected": expected,
                "error": str(e),
                "description": description,
            })
            print(f"[{i}/{total}] {status}")
            print(f"  –ö–µ–π—Å: {description}")
            print(f"  –í–æ–ø—Ä–æ—Å: {text}")
            print(f"  –û—à–∏–±–∫–∞: {e}")
            print()

    await close_db_pool()

    # –ò—Ç–æ–≥–∏
    print("="*80)
    print("–†–ï–ó–£–õ–¨–¢–ê–¢–´ –†–ê–°–®–ò–†–ï–ù–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø")
    print("="*80)
    print(f"–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: {total}")
    print(f"–£—Å–ø–µ—à–Ω–æ: {passed} ({passed*100//total}%)")
    print(f"–ü—Ä–æ–≤–∞–ª–µ–Ω–æ: {failed} ({failed*100//total}%)")
    print()

    if errors_list:
        print("="*80)
        print("–ü–†–û–ë–õ–ï–ú–ù–´–ï –ö–ï–ô–°–´")
        print("="*80)
        for i, error in enumerate(errors_list, 1):
            print(f"\n{i}. –ü–†–û–ë–õ–ï–ú–ê: {error['description']}")
            print(f"   –í–æ–ø—Ä–æ—Å: {error['text']}")
            print(f"   –û–∂–∏–¥–∞–ª–æ—Å—å: {error['expected']}")
            if "got" in error:
                print(f"   –ü–æ–ª—É—á–µ–Ω–æ: {error['got']}")
            if "error" in error:
                print(f"   –û—à–∏–±–∫–∞: {error['error']}")
        print()

        # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–±–ª–µ–º –ø–æ —Ç–∏–ø–∞–º
        print("="*80)
        print("–ö–ê–¢–ï–ì–û–†–ò–ò –ü–†–û–ë–õ–ï–ú")
        print("="*80)

        problem_types = {}
        for error in errors_list:
            desc = error['description']
            # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–∏–ø –ø—Ä–æ–±–ª–µ–º—ã (–¥–æ –ø–µ—Ä–≤–æ–≥–æ '-' –∏–ª–∏ '=')
            problem_type = desc.split('-')[0].split('=')[0].strip()
            if problem_type not in problem_types:
                problem_types[problem_type] = []
            problem_types[problem_type].append(error)

        for ptype, perrors in problem_types.items():
            print(f"\n{ptype}: {len(perrors)} –∫–µ–π—Å–æ–≤")
            for e in perrors:
                print(f"  - {e['text']} ‚Üí –æ–∂–∏–¥–∞–ª–æ—Å—å '{e['expected']}', –ø–æ–ª—É—á–µ–Ω–æ '{e.get('got', 'ERROR')}'")

    return passed, failed


if __name__ == "__main__":
    passed, failed = asyncio.run(run_advanced_tests())
    sys.exit(0 if failed == 0 else 1)
